



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://ksingh7.github.io/data-show/Module-3/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.5.0">
    
    
      
        <title>Module-3 : Introduction to S3A & Loading Sample Data Sets - Ceph Data Show</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.2a88008a.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ksingh7.github.io/data-show/" title="Ceph Data Show" class="md-header-nav__button md-logo">
          
            <img src="../images/shadowman_rgb.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Ceph Data Show
              </span>
              <span class="md-header-nav__topic">
                Module-3 : Introduction to S3A & Loading Sample Data Sets
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../images/shadowman_rgb.png" width="24" height="24">
      
    </span>
    Ceph Data Show
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Module-1/" title="Module-1 : Ceph cluster & Object Storage Setup" class="md-nav__link">
      Module-1 : Ceph cluster & Object Storage Setup
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Module-2/" title="Module-2 : Setting up JupyterHub in OpenShift Container Platform" class="md-nav__link">
      Module-2 : Setting up JupyterHub in OpenShift Container Platform
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Module-3 : Introduction to S3A & Loading Sample Data Sets
      </label>
    
    <a href="./" title="Module-3 : Introduction to S3A & Loading Sample Data Sets" class="md-nav__link md-nav__link--active">
      Module-3 : Introduction to S3A & Loading Sample Data Sets
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#endpoints-credentials-and-ssl" title="Endpoints, Credentials, and SSL" class="md-nav__link">
    Endpoints, Credentials, and SSL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loading-the-sample-data-sets-into-ceph-object-storage" title="Loading the sample data sets into Ceph object storage" class="md-nav__link">
    Loading the sample data sets into Ceph object storage
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Module-4/" title="Module-4 : Analytics on Metrics Data" class="md-nav__link">
      Module-4 : Analytics on Metrics Data
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Module-5/" title="Module-5 : ML using Jupyter Notebooks on Ceph" class="md-nav__link">
      Module-5 : ML using Jupyter Notebooks on Ceph
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#endpoints-credentials-and-ssl" title="Endpoints, Credentials, and SSL" class="md-nav__link">
    Endpoints, Credentials, and SSL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loading-the-sample-data-sets-into-ceph-object-storage" title="Loading the sample data sets into Ceph object storage" class="md-nav__link">
    Loading the sample data sets into Ceph object storage
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="module-3-introduction-to-s3a-loading-sample-data-set">Module - 3 : Introduction to S3A &amp; Loading Sample Data Set<a class="headerlink" href="#module-3-introduction-to-s3a-loading-sample-data-set" title="Permanent link">#</a></h1>
<div class="admonition summary">
<p class="admonition-title">Module Agenda</p>
<ul>
<li><strong>In this module, you will be introduced to the S3A filesystem client</strong></li>
<li><strong>Locally download sample data sets of metrics data and sample trip reports.</strong></li>
<li><strong>Create a bucket and ingest the local data set to your Ceph object store</strong></li>
</ul>
</div>
<ul>
<li>From your workstation, SSH into <code class="codehilite">ceph-node1</code> node as user <strong><code class="codehilite">student</code></strong> and password <strong><code class="codehilite">Redhat18</code></strong> <a href="https://ksingh7.github.io/data-show/#accessing-the-lab">(Need Help..Learn how to Login)</a></li>
</ul>
<div class="codehilite"><pre><span></span>ssh student@&lt;IP Address of ceph-node1 node&gt;
</pre></div>

<div class="admonition example">
<p class="admonition-title">Prerequisite</p>
<ul>
<li><strong>You need to have completed Modules 1-2 before beginning this module</strong></li>
</ul>
</div>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">#</a></h2>
<p>The S3A filesystem client comes from Apache Hadoop and can be utilized by Spark and other tools to interact with a S3 compatible object storage system. S3A is the most feature complete and robust client for interacting with S3 compatible object storage systems, successor to the S3N and S3 filesystem clients. While S3A makes every attempt to map the HDFS API closely to the S3 API, there are some semantic differences inherrent to object storage (Reference: Hadoop Wiki):</p>
<ul>
<li>Eventual Consistency, with Amazon S3, or Multi-site Ceph. Creation, updates, deletes may not be visible for an undefined time.</li>
<li>Non-atomic rename and delete operations. Renaming or deleting large directories takes time proportional to the number of entries and visible to other processes during this time, and indeed, until the eventual consistency has been resolved.</li>
</ul>
<h2 id="endpoints-credentials-and-ssl">Endpoints, Credentials, and SSL<a class="headerlink" href="#endpoints-credentials-and-ssl" title="Permanent link">#</a></h2>
<p>The default endpoint for S3A routes requests to Amazon S3 with SSL (TLS). When interacting with a Ceph object store you will need to change a few S3A configuration parameters, notably the endpoint should be the DNS name or IP address of your Ceph object storage API endpoint.</p>
<ul>
<li>Endpoint (<code class="codehilite">fs.s3a.endpoint</code>)</li>
<li>SSL (<code class="codehilite">fs.s3a.connection.ssl.enabled</code>)</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If HTTP(S) is included in the endpoint definition, then the SSL property is automatically adjusted as appropriate. We will use this convention in the later module when we update the Jupyter Notebook.</p>
</div>
<h2 id="loading-the-sample-data-sets-into-ceph-object-storage">Loading the sample data sets into Ceph object storage<a class="headerlink" href="#loading-the-sample-data-sets-into-ceph-object-storage" title="Permanent link">#</a></h2>
<p>To load the data sets into your Ceph object store we will use S3cmd, a python CLI tool for interacting with S3 compatible object stores. For convenience S3cmd was pre-installed on <code class="codehilite">ceph-node1</code>.</p>
<ul>
<li>
<p>If you have not already done, SSH into <code class="codehilite">ceph-node1</code> as <strong>student</strong> user and <strong><code class="codehilite">Redhat18</code></strong> password.</p>
</li>
<li>
<p>Locally download the sample data sets on <code class="codehilite">ceph-node</code>.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span>wget -O /home/student/kubelet_docker_operations_latency_microseconds.zip https://s3.amazonaws.com/bd-dist/kubelet_docker_operations_latency_microseconds.zip
</pre></div>

<div class="codehilite"><pre><span></span>wget -O /home/student/trip_report.tsv https://s3.amazonaws.com/bd-dist/trip_report.tsv
</pre></div>

<ul>
<li>Unzip the sample metrics data set</li>
</ul>
<div class="codehilite"><pre><span></span>unzip /home/student/kubelet_docker_operations_latency_microseconds.zip -d /home/student/METRICS
</pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The S3 API provides two ways to route requests to a particular bucket. The first is to use a bucket domain name prefix, meaning the API request will be sent to whichever IP address the <bucket_name>.<endpoint> hostname resolves to. If a wildcard DNS subdomain is not configured for the S3 endpoint, or if the endpoint domain name is not configured in Ceph, then requests using this convention will fail. The second way of routing requests is to use path style access, meaning the API request will be sent to <endpoint>/<bucket_name>. We will create a bucket with all upper case letters, as this convention instructs the S3A client to use the latter, path style approach.</p>
</div>
<ul>
<li>Configure <code class="codehilite">S3cmd</code></li>
</ul>
<div class="codehilite"><pre><span></span>s3cmd --access_key=S3user1 --secret_key=S3user1key --no-ssl --host=ceph-admin --host-bucket=&quot;%(bucket)s.ceph-admin&quot; --dump-config &gt; /home/student/.s3cfg
</pre></div>

<ul>
<li>Create bucket for loading the sample metrics data set into Ceph object store</li>
</ul>
<div class="codehilite"><pre><span></span>s3cmd mb s3://METRICS
</pre></div>

<p>Next, we will use the <code class="codehilite">sync</code> S3cmd command to synchronize the local directory with the downloaded data set with the newly created bucket. This is roughly equivalent to using rsync between two filesystems.</p>
<ul>
<li>Sync local directory with METRICS bucket</li>
</ul>
<div class="codehilite"><pre><span></span>s3cmd sync /home/student/METRICS/ s3://METRICS
</pre></div>

<ul>
<li>Verify that metrics dataset is safe and sound in Ceph Object Storage</li>
</ul>
<div class="codehilite"><pre><span></span>s3cmd ls s3://METRICS/kubelet_docker_operations_latency_microseconds/
</pre></div>

<ul>
<li>Create bucket for loading the sample trip report data set into Ceph object store</li>
</ul>
<div class="codehilite"><pre><span></span>s3cmd mb s3://SENTIMENT
</pre></div>

<ul>
<li>Copy local trip report file to SENTIMENT bucket</li>
</ul>
<div class="codehilite"><pre><span></span>s3cmd put /home/student/trip_report.tsv s3://SENTIMENT/data/trip_report.tsv
</pre></div>

<ul>
<li>Verify that trip report dataset is safe and sound in Ceph Object Storage</li>
</ul>
<div class="codehilite"><pre><span></span>s3cmd ls s3://SENTIMENT/data/
</pre></div>

<ul>
<li>Now we have our sample data sets ready to be used in Ceph object store.</li>
</ul>
<div class="admonition summary">
<p class="admonition-title">End of Module</p>
<p><strong>We have reached the end of Module-3. In this module, you downloaded the sample data sets and uploaded them to your Ceph object store using S3cmd. In the next module you will do some basic analysis on these data sets</strong></p>
</div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Module-2/" title="Module-2 : Setting up JupyterHub in OpenShift Container Platform" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Module-2 : Setting up JupyterHub in OpenShift Container Platform
              </span>
            </div>
          </a>
        
        
          <a href="../Module-4/" title="Module-4 : Analytics on Metrics Data" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Module-4 : Analytics on Metrics Data
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright ©2018 Red Hat, Inc.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://www.redhat.com/en/technologies/storage/ceph" class="md-footer-social__link fa fa-link"></a>
    
      <a href="https://twitter.com/RedHatStorage" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://github.com/ceph/ceph" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://www.linkedin.com/company/3545/" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.ce2ab4bf.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>